#!/usr/bin/env php
<?php

namespace rubidium;

$path = dirname(dirname(__FILE__));
require "$path/lib/SplClassLoader.php";

$loader = new \SplClassLoader("rubidium", "$path/lib");
$loader->register();

$file = isset($_SERVER["argv"][1]) ? realpath($_SERVER["argv"][1]) : null;
if (empty($file))
{
    die("Please pass a config file.\n");
}
$server = Server::fromAppFile($file);

if (!isset($_ENV["RUBIDIUM_ENV"]) || empty($_ENV["RUBIDIUM_ENV"]))
{
    $_ENV["RUBIDIUM_ENV"] = "development";
}
$server->start($_ENV["RUBIDIUM_ENV"]);
